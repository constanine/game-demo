项目名称: 冒头冒险游戏 (Console Adventure Game)

核心设计理念: 这是一个基于回合制的冒险游戏，玩家控制一个角色在一个网格化的楼层中探索，与怪物战斗，收集装备和道具，最终目标是击败所有怪物并进入下一层。

主要组成部分:

项目结构:
采用了模块化设计，将代码分解到不同的 Python 文件中，以提高可维护性和可读性。
主要模块包括：
main.py: 程序入口点。
constants.py: 存放游戏常量（屏幕尺寸、颜色、字体）。
enums.py: 定义游戏中使用的枚举类型（游戏状态、装备类型、怪物类型等）。
entities/ 目录: 存放游戏中的核心对象类。
player.py: 玩家类，管理玩家的属性、装备、技能、道具和移动。
monster.py: 怪物类，管理怪物的属性、类型、状态（DE/BUFF）和行为。
equipment.py: 装备类，定义不同部位装备的属性加成。
item.py: 道具类，定义可消耗的物品（苹果、面包、葡萄）。
buff.py: BUFF 和 DEBUFF 类，定义状态效果及其持续时间和影响。
skill.py: 技能类，定义玩家可使用的特殊能力（二连击、割裂、战吼、祝福）。
systems/ 目录: 存放处理特定游戏逻辑的系统。
battle_system.py: 管理战斗的流程、伤害计算和日志记录。
menu_system.py: 负责绘制所有用户界面（地图信息、战斗菜单、主菜单）并处理用户输入。
game_manager.py: 核心的游戏管理器，协调游戏状态（探索、战斗、菜单、结束）、更新游戏逻辑、处理事件循环和主绘制流程。

游戏世界与界面:
屏幕尺寸: 900px (宽) x 760px (高)。
地图: 一个由 40x40 像素网格组成的楼层。玩家从左侧中点进入，需要击败所有怪物后从右侧中点的“出口”进入下一层。
状态显示: 屏幕底部 40px 的区域用于显示玩家当前的楼层、生命值、攻击力、防御力、技力等关键信息。
楼层机制: 游戏按楼层进行，每层地图随机生成固定数量和类型的怪物。击败怪物可获得奖励（天赋点、装备、道具）。
玩家系统:
基础属性: 攻击力 (Attack)、体力 (Health)、防御力 (Defense)、技力 (Energy)。
装备系统: 玩家有 5 个装备槽位（头、胸、左手、右手、足），装备可以提供属性加成。
天赋系统: 击败怪物后获得天赋点，可在菜单中消耗天赋点永久提升基础属性。
道具系统: 玩家可以持有和使用道具（苹果、面包、葡萄）来恢复体力或技力。
技能系统: 玩家拥有 4 个预设技能（二连击、割裂、战吼、祝福），使用技能需要消耗技力。
状态效果 (Buffs/Debuffs): 玩家和怪物都可以受到持续回合的状态效果影响（如“强壮”增加攻击，“恢复”每回合回血，“割裂”每回合掉血，“中毒”按比例掉血）。
战斗系统:
触发: 玩家与怪物碰撞时进入回合制战斗。
界面布局:
左侧 (600px):
动画区 (0-400px): 显示怪物图像和血量。
玩家属性区 (400-600px): 显示玩家当前的详细状态（体力、攻击、防御、技力、Buffs）。
战斗选项区 (600-760px): 显示主战斗选项（战斗、技能、物品、逃跑）或子选项（技能列表、物品列表）。
右侧 (300px): 日志区 (0-760px): 垂直滚动显示战斗过程中的信息（攻击、伤害、状态变化、回合开始等），最新消息在顶部。
操作流程:
玩家回合开始。
玩家从主菜单选择行动：
战斗: 进行一次普通攻击。
技能: 选择并使用一个技能（需要按 Enter 进入子菜单选择具体技能）。
物品: 选择并使用一个道具（需要按 Enter 进入子菜单选择具体物品）。
逃跑: 有 50% 概率成功逃离战斗，回到楼层入口。
执行玩家行动，计算伤害，应用状态效果，检查怪物是否被击败。
如果怪物未被击败，进入怪物回合，怪物进行攻击。
执行怪物行动，计算伤害，应用状态效果，检查玩家是否死亡。
如果玩家和怪物都存活，回到玩家回合开始。
胜负判定: 玩家体力归零则游戏结束；怪物体力归零则战斗胜利，玩家返回探索模式。
菜单系统:
主菜单 (按 'I' 键): 提供能力编辑、装备编辑、道具使用等非战斗时的功能。
战斗菜单: 在战斗中提供行动选项，采用左右分区、上下导航的方式，并支持子菜单（技能、物品）的滚动显示和选择。
技术特点:

面向对象: 代码结构清晰，使用类来封装不同游戏实体和系统的逻辑。
模块化: 通过将功能分解到不同文件，提高了代码的组织性和可维护性。
事件驱动: 使用 Pygame 的事件循环来处理用户输入和游戏更新。
状态管理: 通过 GameState 枚举清晰地管理游戏的不同阶段（探索、战斗、菜单、结束）。
这个设计提供了一个功能丰富、结构清晰的回合制冒险游戏基础框架，具备了角色扮演游戏中常见的核心元素。

需要支持中文,不要乱码

- 人物
  - 控制
    - 以方向键,上下左右,移动操控人物,按键按1帧时间行走0.5个40px宽度的网格
  - 属性
    - 攻击力, 初始数值10
    - 体力, 初始数值100
    - 防御力, 初始数值5
  - 装备栏
    - 头
    - 胸
    - 左手
    - 右手
    - 足
- 装备hash仓库
  - 列表集合形式,记录获取的装备
- 装备
  - 基础属性
      - 附加攻击
      - 附加体力
      - 附加防御
      - 装备部位
      - 阶级:获取时所在楼层
  - 命名
    - 头: [楼层] 头盔
    - 胸: [楼层] 护甲
    - 左手: [楼层] 长剑
    - 右手: [楼层] 护盾
    - 足: [楼层] 靴子
  - 属性赋值公式
    - 头: 楼层 * (随机 1到 3) 的防御力 或 楼层 * (随机 5到 10) 的体力
    - 胸: 楼层 * (随机 10到 20) 的体力
    - 左手: 楼层 * (随机 5到 10) 的攻击力
    - 右手: [楼层] 楼层 * (随机 2到 5) 的防御力
    - 足: 楼层 * (随机 1到 3) 的防御力
- 战斗力计算
  - 玩家
    - 攻击 = 个人攻击属性 + 装备附加攻击力
    - 体力 = 个人体力属性 + 装备附加体力
    - 防御 = 个人防御属性 + 装备附加防御
- 道具
  - 属性
    - 命名
    - 类型
    - 描述
  - 类型列表
    - 苹果, 恢复20点体力,不超过体力最大值
    - 面包, 恢复当前体力最大值的20%,不超过体力最大值
    - 葡萄酒, 恢复20点技力,,不超过技力最大值
- 道具仓库
  - 道具Map集合
    - 显示:道具类型
    - 值: 拥有道具数量
- 怪物
  - 属性
    - 显示可以用图片代替
      - 普通怪物: monster.png
      - 精英怪物: oldmonster.png
      - boss怪物: boss.png
  - 分布如下
      - 普通怪物属性
        - 攻击力: 2*楼层
        - 体力: 20*楼层
        - 防御力: 1*楼层
        - 大小40*40px
        - monster.png 图片替换
        - 每次刷新7-10个
      - 精英怪物属性
        - 攻击力: 5*楼层
        - 体力: 50*楼层
        - 防御力: 2*楼层
        - 大小60*60px
        - oldmonster.png 图片替换
        - 每次刷新 2-3 个
      - Boss怪物属性
        - 攻击力: 15*楼层
        - 体力: 150*楼层
        - 防御力: 5*楼层
        - 大小80*80px
        - boss.png 图片替换
        - 每次刷新1个
- 战斗
  - 战斗机制
    - 回合制,玩家1次战斗选项,怪物一次攻击
      - 在玩家使用攻击,则 怪物体力 = 怪物当前体力 - （玩家攻击力总和-怪物防御),当怪物体力小于等于0,战斗胜利,回到地图
      - 玩家使用技能,则按技能公式扣除怪物体力,当怪物体力小于等于0,战斗胜利,回到地图
      - 玩家回合结束后,怪物发动攻击,以当前怪物的攻击力总和减去人物的防御力总和,作为伤害,然后以伤害值扣除人物体力总和,如果人物体力正好扣完,则战斗失败,退出战斗,游戏结束
      - 每次战斗结束后,体力剩余值保留
  - 战斗失败,游戏结束
  - 战斗胜利,怪物会给与人物道具或装备
     - 每次战斗胜利,给予人物1点天赋
     - 普通怪物战斗胜利后
        - 苹果 1个: 80%概率
        - 葡萄酒1个: 50%概率
        - 当前楼层阶装备 1个, 装备类型随机: 20%概率
     - 精英怪物战斗胜利后
        - 当前楼层阶装备, 装备类型随机: 100%概率
        - 苹果 1个: 100%概率
        - 面包: 50% 概率
     - Boss怪物属性战斗胜利后
        - 下层楼层阶装备 1个, 装备类型随机: 50% 概率
        - 当前楼层阶装备 2个, 装备类型随机: 100% 概率
        - 面包 1个: 100% 概率

- 主菜单
  - 按键"I",出现功能菜单
  - 目前菜单
    - 能力编辑
    - 装备编辑
    - 装备合成
    - 道具使用
  - 能力编辑
    - 消耗1点天赋,增加3点攻击
    - 消耗1点天赋,增加10点体力
    - 消耗1点天赋,增加1点防御
    - 消耗1点天赋,增加3点技力
    - 最后1个取消菜单,返回上一级
  - 装备编辑
    - 显示当前玩家装备部位,穿戴的装备
    - 先左边选择部位,按"enter"键, 刷新右边装备列表,如果右边列表有装备,则将选择指针,移到右边
      - 按上下选择装备穿戴,按"enter"确认穿戴,指针回到左边部位列表
      - 或者按"Esc"、"退格"键都取消选择指,针回到左边部位列表
    - 最后1个取消菜单,返回上一级
  - 道具使用
    - 将人物身上的道具显示,按 1行 显示1种类型道具以及其拥有个数, 选中后,按"enter"确认使用,使用后按属性恢复体力或技力,同时拥有数量减1
    - 最后1个取消菜单,返回上一级
  - 装备合成
    - 选择3个相同楼层阶的装备合成下一层楼层的装备
    - 最后1个取消菜单,返回上一级
  - 最后1个取消菜单,返回地图

- 界面
- 屏幕大小改为900*760
- 地图
  - 地图最左边中点作为入口,以及初始点,标记黑色
  - 地图最右边的中点作为出口,进入下一层地图,当一只怪物都不存在,才能触发进入下一层
  - 当有任一只怪物存在,锁定出口,标记为灰色
  - 当一只怪物都不存在,出口开放,标记为黄色
  - 怪物清光后,出口变黄色。触碰没有进入下一层
- 战斗界面
  - 战斗界面
    - 左侧 600px，右侧300px
    - 左侧 战斗区域
        - 600*px宽度,0到400px高度,预留播放战斗动画
          - 显示怪物血量
          - 显示怪物个数
        - 600px宽度,200px高度(400到600px),为玩家属性
          - 显示剩余体力
          - 显示攻防属性
        - 底部600px宽度,160px高度(600到760px),为战斗选项
          - 默认战斗选项是战斗
          - 只有选中了"技能",并且按了"enter"键,才出现子菜单,
          - 只有选中了"物品",并且按了"enter"键,才出现子菜单,
          - 子菜单最后一行都是取消
          - 因为子菜单可能过长,所以列表高度超过200px,也就是5个选项后,作滚动处理:rollover处理
    - 右侧为日志区,最新战斗信息在最上层,消息从新到旧,按从上到下排序
      - 300px宽度,760px高度


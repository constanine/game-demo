使用python 编写一款小游戏(二)
- 屏幕为800乘800px大小,实际是40px宽度的网格
- 以40乘40px大小的小人作为操控人物
- 人物
  - 属性
    - 攻击力, 初始数值10
    - 体力, 初始数值100
    - 防御力, 初始数值5
  - 控制
    - 以方向键,上下左右,移动操控人物,按键按1帧时间行走0.5个40px宽度的网格
  - 装备栏
    - 头
    - 胸
    - 左手
    - 右手
    - 足
- 装备
  - 命名
    - 头: [楼层] 头盔
    - 胸: [楼层] 护甲
    - 左手: [楼层] 长剑
    - 右手: [楼层] 护盾
    - 足: [楼层] 靴子
  - 属性
    - 头: 楼层 * (随机 1到 3) 的防御力 或 楼层 * (随机 5到 10) 的体力
    - 胸: 楼层 * (随机 10到 20) 的体力
    - 左手: 楼层 * (随机 5到 10) 的攻击力
    - 右手: [楼层] 楼层 * (随机 2到 5) 的防御力
    - 足: 楼层 * (随机 1到 3) 的防御力
- 道具
  - 苹果, 恢复20点体力,不超过体力最大值
  - 面包, 恢复当前体力最大值的20%,不超过体力最大值
- 地图最左边中点作为入口,以及初始点,标记黑色
- 地图最右边的中点作为出口,进入下一层地图,当一只怪物都不存在,才能触发进入下一层
  - 当有任一只怪物存在,锁定出口,标记为灰色
  - 当一只怪物都不存在,出口开放,标记为黄色
- 每层地图,屏幕随机10个出现怪物,人物体力恢复至当前人物属性+装备的计算总和
- 碰撞范围态.应超过超过20%重合就算触碰
- 一旦触碰,进入回合制战斗控制界面
  - 战斗界面如下
    - 左上600*600px 预留播放战斗动画,可以先空白
    - 底部200px高度,为战斗选项界面
      主要出现3个选项
         - 战斗, 以当前人物的攻击力总和减去怪物的防御力,作为伤害,然后以伤害值扣除怪物体力,如果怪物体力正好扣完,则战斗胜利,退出战斗,否正回合结束,轮到怪物行动
         - 物品, 显示人物目前拥有的道具栏,选中1个道具使用,结束回合,轮到怪物行动
         - 逃跑, 50%概率成功,退出战斗,人物回到入口点
    - 玩家回合结束后,怪物发动攻击,以当前怪物的攻击力总和减去人物的防御力总和,作为伤害,然后以伤害值扣除人物体力总和,如果人物体力正好扣完,则战斗失败,退出战斗,游戏结束
    - 每次战斗结束后,体力剩余值保留
    - 战斗胜利,给予人物1点天赋
- 游戏结束,则黑色背景
  - 显示玩家达到层数的 Top5
  - 出现菜单选项,重新开始
- 怪物可以用图片代替,找不到用红色圆点代替
  - 怪物分布如下,7个普通怪物,2个精英怪物,1个boss怪物
      - 普通怪物属性
        - 攻击力: 2*楼层
        - 体力: 20*楼层
        - 防御力: 1*楼层
        - 大小40*40px
        - 普通怪物图片替换
      - 精英怪物属性
        - 攻击力: 5*楼层
        - 体力: 50*楼层
        - 防御力: 2*楼层
        - 大小60*60px
        - 精英怪物图片替换
      - Boss怪物属性
        - 攻击力: 15*楼层
        - 体力: 150*楼层
        - 防御力: 5*楼层
        - 大小80*80px
        - BOSS怪物图片替换
  - 战斗胜利,怪物会给与人物道具或装备
     - 普通怪物属性
        - 苹果 1个: 80%概率
        - 当前楼层阶装备 1个, 装备类型随机: 20%概率
     - 精英怪物属性
        - 当前楼层阶装备, 装备类型随机: 100%概率
        - 面包: 100% 概率
     - Boss怪物属性
        - 下层楼层阶装备 1个, 装备类型随机: 50% 概率
        - 当前楼层阶装备 2个, 装备类型随机: 100% 概率
        - 面包 1个: 100% 概率
- 增加菜单
  - 按键"I",出现功能菜单
  - 目前菜单
    - 能力编辑
    - 装备编辑
    - 装备合成
    - 道具使用
  - 能力编辑
    - 消耗1点天赋,增加5点攻击
    - 消耗1点天赋,增加15点体力
    - 消耗1点天赋,增加2点防御
    - 最后1个取消菜单,返回上一级
  - 装备编辑
    - 给5个部位穿上装备
    - 最后1个取消菜单,返回上一级
  - 道具使用
    - 将人物身上的道具显示,按 1行 显示1种 道具, 选中后,当即使用
    - 最后1个取消菜单,返回上一级
  - 装备合成
    - 选择3个相同楼层阶的装备合成下一层楼层的装备
    - 最后1个取消菜单,返回上一级
  - 最后1个取消菜单,返回地图
  - 菜单需要支持中文,不要乱码

补充需求:
 1. 游戏激活状态,地图背景应该是浅绿色或土黄色,而不是黑色
 2. 玩家和怪物的碰撞没有触发战斗
 3. 菜单界面按回车,没有进入选中的菜单项

补充需求:
1. 怪物刷新重叠,需要保证每个怪物位置不重叠
2. 菜单功能:能力编辑,装备编辑,装备合成,道具使用 都没实现

问题
目前,代码又导致战斗界面的菜单无法选择,与使用

补充需求:
1. 怪物应该固定7个普通怪,2个精英,1个boss怪物
2. 屏幕改小点,改成800*640,其次底部40px边距用来,输出战斗或道具获取信息,就是printf应该在底部40px的横条上展示
3. 装备不属于道具,不用再道具菜单中展示, 装备编辑中，左边是装备选项, 右边应该是装备列表切,通过左边选择部位(回车键)后,开始右边装备栏选择对应部位的装备,按回车确认,选中的装备属性会加入玩家属性计算

道具使用出现异常
```
Traceback (most recent call last):
  File "E:\CodeProjects\GIT-Test-WORK\qwen-game-demo\game3\main.py", line 83, in <module>
    menu_result = menu.run()
  File "E:\CodeProjects\GIT-Test-WORK\qwen-game-demo\game3\menu.py", line 50, in run
    result = self.handle_menu_option(selected)
  File "E:\CodeProjects\GIT-Test-WORK\qwen-game-demo\game3\menu.py", line 63, in handle_menu_option
    return self.item_use()
  File "E:\CodeProjects\GIT-Test-WORK\qwen-game-demo\game3\menu.py", line 274, in item_use
    self.player.inventory.remove(item)
ValueError: list.remove(x): x not in list

Process finished with exit code 1
```

补充需求:
- 怪物清光后,出口变黄色了。但是触碰没有进入下一层
- 战斗中道具使用,似乎没恢复体力
    - 道具
      - 苹果, 恢复20点体力,不超过体力最大值
      - 面包, 恢复当前体力最大值的20%,不超过体力最大值
- I键进入菜单时, 右边显示当前人物属性, 攻击力,当前体力,防御力
- 所有"返回"选项在选中时,出现红色



补充需求:
- 战斗界面需要重新调整
    - 600*px宽度,0到400px高度,预留播放战斗动画,可以先空白
    - 600px宽度,120px高度(400到600px),为战斗选项界面
    - 底部600px宽度,120px高度(600到640px),为日志信息输出界面
    - 日志信息保留最后3条
- 玩家回合开始,和怪物回合开始都要出现1个信息提醒,"玩家回合开始","怪物回合开始"
- 道具使用后也建议不要全屏遮盖提示"使用了苹果"
  - 战斗界面则再日志区域显示
  - 菜单界面,中间区域弹框提示,并且此时应该锁定其他按键等待提示框消失
- 装备编辑,右边应该出现对应部位的所有装备,且以黄色作为选中标记
- 装备编辑,左边,应该显示已穿戴的装备
- 装备合成,3个相同楼层N阶级的装备可以消耗掉,出现N+1阶级的装备

补充需求:
1. 玩家战斗伤害日志没有输出
2. 使用到具体,应该提示中带出使用效果,例如"使用了苹果,恢复了20点体力","使用了面包恢复了20%体力"这样

补充需求:
- 请保证游戏出现的中文显示不要乱码
- 地图界面左上角,显示当前楼层
- 能力编辑的界面,应该在右边显示修改后的属性,其次显示搭当前剩余天赋点数
- 装备编辑,右边应该出现对应部位的所有装备,切以黄色作为选中标记
- 装备合成,3个相同楼层N阶级的装备可以消耗掉,出现N+1阶级的装备

补充需求:
- 战斗界面需要重新调整
    - 左侧 600px，右侧200px
    - 左侧 战斗区域
        - 600*px宽度,0到400px高度,预留播放战斗动画
          - 显示怪物血量
          - 显示怪物个数
        - 600px宽度,200px高度(400到600px),为玩家属性
          - 显示剩余体力
          - 显示攻防属性
        - 底部600px宽度,40px高度(600到640px),为战斗选项
    - 右侧为日志区,最新战斗信息在最上层,消息从新到旧,按从上到下排序

补充需求
- 玩家添加"技力"属性,默认值20点
- 添加"BUFF"模块
  - 强壮
    - 持续3个战斗回合
    - 攻击力增加30%
  - 恢复
    - 持续3个战斗回合
    - 每回合体力恢复20%
- 添加"DEBUFF"模块
  - 割裂
    - 持续3个战斗回合
    - 每回合损失20点体力
  - 中毒
    - 持续3个战斗回合
    - 每回合损失总体力的10%
- 添加"技能"模块
  - 二连击
    - 按连续攻击2次计算
    - 消耗5点技力
  - 割裂
    - 1次攻击计算
    - 目标怪物,获得 DEBUFF: 割裂
    - 消耗5点技力
  - 战吼
    - 给予玩家 BUFF:强壮
    - 消耗5点技力
  - 祝福
    - 给予玩家 BUFF:恢复
    - 消耗5点技力
- 战斗选项添加"技能"选项
- 能力编辑新增选项: 消耗1点天赋,技力增加2点
- 道具增加一项,道具名:葡萄,效果恢复20点技力
- 普通怪物增加50%概率掉落葡萄

以上代码,2个问题，
1. 战斗选项,排布式1行4个,但是选择缺用上下,而不是左右, 希望改成左右,且添加在左边添加1个三角标识选中
2. 战斗选项:技能,物品 2个选项不可用

以上代码,2个问题，
1. 战斗界面,属性字体可以缩小点,建议在30px左右
2. 战斗选项的区域高度态小,本来希望4个选项是1列不是1排,应该用上下选择,建议保证只剩200px高度
3. 战斗选项:技能,应该出现子菜单,二连击，割裂 ，战吼，祝福
4. 二连击,技能应该对怪物造成2次攻击伤害,现在没有计算2次攻击的伤害

以上代码,3个问题，
2. 战斗选项的区域高度保证200px高度
3. 技能选项,应该出现子菜单, 有二连击，割裂 ，战吼，祝福 4个选项
4. 物品应该出现子菜单,右边显示物品列表,可以选择并使用
